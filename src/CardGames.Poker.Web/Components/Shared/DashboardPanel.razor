@namespace CardGames.Poker.Web.Components.Shared

@inject Services.DashboardState DashboardState
@implements IDisposable

<div class="dashboard-panel @(DashboardState.IsOpen ? "expanded" : "collapsed")">
    <button class="dashboard-toggle" 
            @onclick="DashboardState.Toggle" 
            aria-expanded="@DashboardState.IsOpen" 
            aria-controls="dashboard-content"
            aria-label="@(DashboardState.IsOpen ? "Close dashboard" : "Open dashboard")">
        <span class="toggle-icon">
            @if (DashboardState.IsOpen)
            {
                <i class="fa-solid fa-chevron-left"></i>
            }
            else
            {
                <i class="fa-solid fa-chevron-right"></i>
            }
        </span>
        <span class="toggle-label">@(DashboardState.IsOpen ? "" : "Stats")</span>
    </button>

    <div id="dashboard-content" class="dashboard-content">
        <div class="dashboard-header">
            <i class="fa-solid fa-chart-line"></i>
            <span>Dashboard</span>
        </div>

        <div class="dashboard-sections">
            @ChildContent
        </div>
    </div>
</div>

@code {
    /// <summary>
    /// The content (sections) to display inside the dashboard panel.
    /// </summary>
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    protected override void OnInitialized()
    {
        DashboardState.OnStateChanged += StateHasChanged;
    }

    public void Dispose()
    {
        DashboardState.OnStateChanged -= StateHasChanged;
    }
}
